–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Ubuntu 22.04) –∑–∞–º–µ—á–µ–Ω–æ, —á—Ç–æ –ø–æ—Ä—Ç 8080 –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ—Ç–∫—Ä—ã—Ç:


ss -ltnp | grep 8080
# LISTEN 0 128 0.0.0.0:8080


–ù–æ:

- lsof -i :8080 –∏ fuser 8080/tcp ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç  
- ps aux ‚Äî —Ç–æ–∂–µ –Ω–∏—á–µ–≥–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ  
- kill -9 PID –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç ‚Äî –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è  
- –ü–æ—Å–ª–µ reboot ‚Äî –ø–æ—Ä—Ç —Å–Ω–æ–≤–∞ —Å–ª—É—à–∞–µ—Ç—Å—è  
- UFW/iptables ‚Äî —á–∏—Å—Ç–æ  
- SELinux ‚Äî –æ—Ç–∫–ª—é—á—ë–Ω

üîç –í–∞—à–∞ –∑–∞–¥–∞—á–∞:

- –ù–∞–π—Ç–∏, –∫—Ç–æ —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 8080  
- –ü–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É lsof –∏ fuser –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç  
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ

üí£ –ü–æ–¥–≤–æ—Ö–∏ –∏ –ø—Ä–∏—á–∏–Ω—ã:

1. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω –≤ user namespace –∏–ª–∏ network namespace  
2. –ü–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç systemd —á–µ—Ä–µ–∑ socket activation  
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LD_PRELOAD –∏–ª–∏ ptrace –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞  
4. –ó–∞–ø—É—â–µ–Ω –∫–∞–∫ chroot`-–∏–∑–æ–ª—è—Ç –∏–ª–∏ –≤ `unshare -n  
5. ExecStartPre –≤ systemd –∑–∞–ø—É—Å–∫–∞–µ—Ç nc`/`python3 -m http.server –¥–æ –∑–∞–ø—É—Å–∫–∞ —Å–∞–º–æ–π —Å–ª—É–∂–±—ã

üõ† –ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é:

- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å systemd-—é–Ω–∏—Ç—ã:  
  

  systemctl list-units --type=service
  systemctl cat suspicious.service
  

- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å namespace-—ã:
  

  lsns | grep net
  

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å auditd –∏–ª–∏ strace:
  

  strace -f -p $(pidof ss)
  

- –ü—Ä–æ–π—Ç–∏ –ø–æ /proc/<pid>/fd, –µ—Å–ª–∏ PID –≤—Å—ë-—Ç–∞–∫–∏ –µ—Å—Ç—å
